
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://synalinks.github.io/synalinks/Synalinks%20API/Programs%20API/The%20Program%20class/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../The%20Sequential%20class/">
      
      
      <link rel="icon" href="../../../assets/synalinks_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>The Program class - Synalinks</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-program-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Synalinks" class="md-header__button md-logo" aria-label="Synalinks" data-md-component="logo">
      
  <img src="../../../assets/synalinks_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Synalinks
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Program class
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/SynaLinks/synalinks" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    SynaLinks/synalinks
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Synalinks" class="md-nav__button md-logo" aria-label="Synalinks" data-md-component="logo">
      
  <img src="../../../assets/synalinks_logo.png" alt="logo">

    </a>
    Synalinks
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SynaLinks/synalinks" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    SynaLinks/synalinks
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FAQ/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Code Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Code Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Basics/First%20Steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First Steps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Basics/First%20Programs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First Programs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Basics/Control%20Flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Basics/Conversational%20Applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conversational Applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Basics/Reward%20Metrics%20And%20Optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rewards, Metrics &amp; Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Basics/Training%20Programs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Programs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Advanced/Implementing%20Custom%20Modules%20And%20Programs%20Via%20Subclassing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementing custom modules &amp; programs via subclassing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Advanced/First%20Knowledge%20Graph%20Schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First Knowledge Graph Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Advanced/Knowledge%20Extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Extraction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20Examples/Advanced/Retrieval%20Augmented%20Generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Retrieval Augmented Generation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Synalinks API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Synalinks API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Language%20Models%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Language Models API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Embedding%20Models%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding Models API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Knowledge%20Bases%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Bases API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Models API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Data Models API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Models%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Models API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Models%20API/The%20DataModel%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The DataModel class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Models%20API/The%20JsonDataModel%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The JsonDataModel class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Models%20API/The%20SymbolicDataModel%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The SymbolicDataModel class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Models%20API/The%20Variable%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Variable class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Models%20API/The%20Base%20DataModels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Base DataModels
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programs API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Programs API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Programs API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    The Program class
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    The Program class
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program" class="md-nav__link">
    <span class="md-ellipsis">
      Program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--with-the-functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      With the "Functional API"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--by-subclassing-the-program-class" class="md-nav__link">
    <span class="md-ellipsis">
      By subclassing the Program class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--mixing-the-subclassing-and-the-functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      Mixing the subclassing and the Functional API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--with-the-sequential-class" class="md-nav__link">
    <span class="md-ellipsis">
      With the Sequential class
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.get_module" class="md-nav__link">
    <span class="md-ellipsis">
      get_module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.get_state_tree" class="md-nav__link">
    <span class="md-ellipsis">
      get_state_tree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.load_variables" class="md-nav__link">
    <span class="md-ellipsis">
      load_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.save_variables" class="md-nav__link">
    <span class="md-ellipsis">
      save_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.set_state_tree" class="md-nav__link">
    <span class="md-ellipsis">
      set_state_tree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../The%20Sequential%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Sequential class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Program%20training%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Program training API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5_5" id="__nav_5_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Program Saving API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5_5">
            <span class="md-nav__icon md-icon"></span>
            Program Saving API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Program%20Saving%20API/Program%20saving%20and%20loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Program saving and loading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Program%20Saving%20API/Variable%20saving%20and%20loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variable saving and loading
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modules API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Modules API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Base%20Module%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Module class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_3" >
        
          
          <label class="md-nav__link" for="__nav_5_6_3" id="__nav_5_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_3">
            <span class="md-nav__icon md-icon"></span>
            Core Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Input%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Input module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Identity%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identity module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Not%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Not module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Generator%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Decision%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decision module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Action%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Action module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Core%20Modules/Branch%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Branch module
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_4" >
        
          
          <label class="md-nav__link" for="__nav_5_6_4" id="__nav_5_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Knowledge Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_4">
            <span class="md-nav__icon md-icon"></span>
            Knowledge Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Knowledge%20Modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Knowledge%20Modules/Embedding%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Knowledge%20Modules/UpdateKnowledge%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UpdateKnowledge module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Knowledge%20Modules/EntityRetriever%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EntityRetriever module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Knowledge%20Modules/KnowledgeRetriever%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KnowledgeRetriever module
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_5" >
        
          
          <label class="md-nav__link" for="__nav_5_6_5" id="__nav_5_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Merging Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_5">
            <span class="md-nav__icon md-icon"></span>
            Merging Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Merging%20Modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Merging Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Merging%20Modules/Concat%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concat module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Merging%20Modules/And%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    And module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Merging%20Modules/Or%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Or module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Merging%20Modules/Xor%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Xor module
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6_6" id="__nav_5_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Test Time Compute Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_6">
            <span class="md-nav__icon md-icon"></span>
            Test Time Compute Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Test%20Time%20Compute%20Modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test Time Compute Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Test%20Time%20Compute%20Modules/ChainOfThought%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ChainOfThought module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Test%20Time%20Compute%20Modules/SelfCritique%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SelfCritique module
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_7" >
        
          
          <label class="md-nav__link" for="__nav_5_6_7" id="__nav_5_6_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Agents Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_7">
            <span class="md-nav__icon md-icon"></span>
            Agents Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Agents%20Modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Modules%20API/Agents%20Modules/ReACT%20Agent%20module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ReACT Agent module
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Callbacks API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Callbacks API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Callbacks%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Callbacks API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Callbacks%20API/Base%20Callback%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Callback class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Callbacks%20API/ProgramCheckpoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ProgramCheckpoint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Callbacks%20API/CSVLogger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSVLogger
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ops API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Ops API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ops%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ops API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ops%20API/JSON%20Ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JSON Ops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ops%20API/Language%20Models%20Ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Language Models Ops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ops%20API/Embedding%20Models%20Ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding Models Ops
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_9" >
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimizers API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            Optimizers API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Optimizers%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Optimizers%20API/Base%20Optimizer%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Optimizer class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Optimizers%20API/RandomFewShot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RandomFewShot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Optimizers%20API/OPRO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OPRO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Optimizers%20API/FewShotOPRO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FewShotOPRO
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            Metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metrics/Base%20Metric%20class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Metric class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metrics/Metric%20wrappers%20and%20reduction%20metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metric wrappers and reduction metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metrics/Regression%20metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regression metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metrics/FScore%20metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FScore metrics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_11" >
        
          
          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Rewards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            Rewards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rewards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rewards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rewards/ExactMatch%20reward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ExactMatch reward
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rewards/CosineSimilarity%20reward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CosineSimilarity reward
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rewards/LMAsJudge%20reward/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LMAsJudge reward
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rewards/Reward%20wrappers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reward wrappers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Built-in Datasets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            Built-in Datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Built-in%20Datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Built-in Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Built-in%20Datasets/GSM8K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GSM8K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Built-in%20Datasets/HotpotQA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HotpotQA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Built-in%20Datasets/ARC-AGI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ARC AGI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          <label class="md-nav__link" for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Utilities/Program%20plotting%20utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Program plotting utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Utilities/More%20plotting%20utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    More plotting utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Utilities/NLP%20utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NLP utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Deployment/Building%20a%20REST%20API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building a REST API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Deployment/Enabling%20LM%20Tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enabling LM Tracing with Arize Phoenix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program" class="md-nav__link">
    <span class="md-ellipsis">
      Program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--with-the-functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      With the "Functional API"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--by-subclassing-the-program-class" class="md-nav__link">
    <span class="md-ellipsis">
      By subclassing the Program class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--mixing-the-subclassing-and-the-functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      Mixing the subclassing and the Functional API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program--with-the-sequential-class" class="md-nav__link">
    <span class="md-ellipsis">
      With the Sequential class
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.get_module" class="md-nav__link">
    <span class="md-ellipsis">
      get_module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.get_state_tree" class="md-nav__link">
    <span class="md-ellipsis">
      get_state_tree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.load_variables" class="md-nav__link">
    <span class="md-ellipsis">
      load_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.save_variables" class="md-nav__link">
    <span class="md-ellipsis">
      save_variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.set_state_tree" class="md-nav__link">
    <span class="md-ellipsis">
      set_state_tree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synalinks.src.programs.program.Program.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="the-program-class">The Program class</h1>


<div class="doc doc-object doc-class">



<a id="synalinks.src.programs.program.Program"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="synalinks.src.trainers.trainer.Trainer" href="../Program%20training%20API/#synalinks.src.trainers.trainer.Trainer">Trainer</a></code>, <code><a class="autorefs autorefs-internal" title="synalinks.src.modules.Module" href="../../Modules%20API/Base%20Module%20class/#synalinks.src.modules.module.Module">Module</a></code></p>


        <p>A program grouping modules into an object with training/inference features.</p>
<p>There is four ways to instantiate a <code>Program</code>:</p>
<h3 id="synalinks.src.programs.program.Program--with-the-functional-api">With the "Functional API"</h3>
<p>You start from <code>Input</code>, you chain modules calls to specify the program's structure,
and finally, you create your program from inputs and outputs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">synalinks</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The user query&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnswerWithThinking</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">thinking</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Your step by step thinking process&quot;</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">answer</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The correct numerical answer&quot;</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">language_model</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">LanguageModel</span><span class="p">(</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ollama/mistral&quot;</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">x0</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">data_model</span><span class="o">=</span><span class="n">Query</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="k">await</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="n">data_model</span><span class="o">=</span><span class="n">AnswerWithThinking</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="p">)(</span><span class="n">x0</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="n">program</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Program</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="n">outputs</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;chain_of_thought&quot;</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Useful to answer in a step by step manner.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<p>Note: Only dicts, lists, and tuples of input data models are supported. Nested
inputs are not supported (e.g. lists of list or dicts of dict).</p>
<h3 id="synalinks.src.programs.program.Program--by-subclassing-the-program-class">By subclassing the <code>Program</code> class</h3>
<p>In that case, you should define your
modules in <code>__init__()</code> and you should implement the program's structure
in <code>call()</code> .</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">synalinks</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The user query&quot;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="p">)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnswerWithThinking</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">thinking</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Your step by step thinking process&quot;</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">answer</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The correct numerical answer&quot;</span><span class="p">,</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="p">)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChainOfThought</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">Program</span><span class="p">):</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Useful to answer in a step by step manner.</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="sd">    The first line of the docstring is provided as description</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="sd">    for the program if not provided in the `super().__init__()`.</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="sd">    In a similar way the name is automatically infered based on</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="sd">    the class name if not provided.</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>        <span class="n">language_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>        <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>    <span class="p">):</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>            <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">,</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>        <span class="p">)</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>            <span class="n">data_model</span><span class="o">=</span><span class="n">AnswerWithThinking</span><span class="p">,</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>            <span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;_generator&quot;</span><span class="p">,</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>        <span class="p">)</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inputs</span><span class="p">:</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>        <span class="n">x</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>        <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>            <span class="s2">&quot;trainable&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainable</span><span class="p">,</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>        <span class="p">}</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>        <span class="n">language_model_config</span> <span class="o">=</span>             <span class="p">{</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>            <span class="s2">&quot;language_model&quot;</span><span class="p">:</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">saving</span><span class="o">.</span><span class="n">serialize_synalinks_object</span><span class="p">(</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">language_model</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>            <span class="p">)</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>        <span class="p">}</span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a>        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">language_model_config</span><span class="p">}</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a>        <span class="n">language_model</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">saving</span><span class="o">.</span><span class="n">deserialize_synalinks_object</span><span class="p">(</span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a>            <span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;language_model&quot;</span><span class="p">)</span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a>        <span class="p">)</span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a>    <span class="n">language_model</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">LanguageModel</span><span class="p">(</span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a>        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ollama/mistral&quot;</span><span class="p">,</span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a>    <span class="p">)</span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a>    <span class="n">program</span> <span class="o">=</span> <span class="n">ChainOfThought</span><span class="p">(</span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a>        <span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a>    <span class="p">)</span>
</code></pre></div>
<p>If you subclass <code>Program</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call()</code>, which you can use to specify
a different behavior in training and inference.</p>
<p>Once the program is created, you can config the program with rewards and metrics
with <code>program.compile()</code>, train the program with <code>program.fit()</code>, or use the program
to do prediction with <code>program.predict()</code> or <code>program()</code>.</p>
<p>To understand the difference between <code>program.predict()</code> or <code>program()</code>, read the
<a href="https://synalinks.github.io/synalinks/FAQ/#whats-the-difference-between-program-methods-predict-and-__call__">FAQ</a>.</p>
<h3 id="synalinks.src.programs.program.Program--mixing-the-subclassing-and-the-functional-api">Mixing the subclassing and the <code>Functional</code> API</h3>
<p>This way of programming is recommended to encapsulate your application while 
providing an easy to use setup. It is the recommended way for most users as 
it avoid making your program/agents from scratch.
In that case, you should implement only the <code>__init__()</code> and <code>build()</code> methods.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">synalinks</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The user query&quot;</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnswerWithThinking</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="n">thinking</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Your step by step thinking process&quot;</span><span class="p">,</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    <span class="p">)</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="n">answer</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The correct numerical answer&quot;</span><span class="p">,</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="p">)</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">ChainOfThought</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">Program</span><span class="p">):</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Useful to answer in a step by step manner.&quot;&quot;&quot;</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>            <span class="n">language_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>            <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>            <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>            <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>        <span class="p">):</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>                <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>                <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">,</span>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>            <span class="p">)</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">language_model</span> <span class="o">=</span> <span class="n">language_model</span>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>            <span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>                <span class="n">data_model</span><span class="o">=</span><span class="n">AnswerWithThinking</span><span class="p">,</span>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>                <span class="n">language_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>            <span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>            <span class="c1"># Create your program using the functional API</span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>                <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>                <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>                <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>                <span class="n">trainable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trainable</span><span class="p">,</span>
<a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>            <span class="p">)</span>
<a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>
<a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>    <span class="n">language_model</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">LanguageModel</span><span class="p">(</span>
<a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ollama/mistral&quot;</span><span class="p">,</span>
<a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>    <span class="p">)</span>
<a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>
<a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a>    <span class="n">program</span> <span class="o">=</span> <span class="n">ChainOfThought</span><span class="p">(</span>
<a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>        <span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>    <span class="p">)</span>
<a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>
<a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<p>This allows you to not have to implement the <code>call()</code> and serialization methods
(<code>get_config()</code> and <code>from_config()</code>). The program will be built for any inputs 
the first time called.</p>
<h3 id="synalinks.src.programs.program.Program--with-the-sequential-class">With the <code>Sequential</code> class</h3>
<p>In addition, <code>synalinks.Sequential</code> is a special case of program where
the program is purely a stack of single-input, single-output modules.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">synalinks</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The user query&quot;</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnswerWithThinking</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">thinking</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Your step by step thinking process&quot;</span><span class="p">,</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="p">)</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="n">answer</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The correct numerical answer&quot;</span><span class="p">,</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="p">)</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    <span class="n">language_model</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">LanguageModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;ollama/mistral&quot;</span><span class="p">)</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>    <span class="n">program</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>        <span class="p">[</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>            <span class="n">synalinks</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>                <span class="n">data_model</span><span class="o">=</span><span class="n">Query</span><span class="p">,</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>            <span class="p">),</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>            <span class="n">synalinks</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>                <span class="n">data_model</span><span class="o">=</span><span class="n">AnswerWithThinking</span><span class="p">,</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>                <span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>            <span class="p">),</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>        <span class="p">],</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;chain_of_thought&quot;</span><span class="p">,</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Useful to answer in a step by step manner.&quot;</span><span class="p">,</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>    <span class="p">)</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="nd">@synalinks_export</span><span class="p">([</span><span class="s2">&quot;synalinks.Program&quot;</span><span class="p">,</span> <span class="s2">&quot;synalinks.programs.Program&quot;</span><span class="p">])</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">class</span><span class="w"> </span><span class="nc">Program</span><span class="p">(</span><span class="n">Trainer</span><span class="p">,</span> <span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A program grouping modules into an object with training/inference features.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    There is four ways to instantiate a `Program`:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    ## With the &quot;Functional API&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    You start from `Input`, you chain modules calls to specify the program&#39;s structure,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    and finally, you create your program from inputs and outputs:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    import synalinks</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    import asyncio</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    class Query(synalinks.DataModel):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        query: str = synalinks.Field(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            description=&quot;The user query&quot;,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        )</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    class AnswerWithThinking(synalinks.DataModel):</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        thinking: str = synalinks.Field(</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            description=&quot;Your step by step thinking process&quot;,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        )</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        answer: float = synalinks.Field(</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            description=&quot;The correct numerical answer&quot;,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        )</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    async def main():</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        language_model = synalinks.LanguageModel(</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            model=&quot;ollama/mistral&quot;,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        )</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        x0 = synalinks.Input(data_model=Query)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        x1 = await synalinks.Generator(</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            data_model=AnswerWithThinking,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">            language_model=language_model,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        )(x0)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        program = synalinks.Program(</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            inputs=x0,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            outputs=x1,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            name=&quot;chain_of_thought&quot;,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            description=&quot;Useful to answer in a step by step manner.&quot;,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        )</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    if __name__ == &quot;__main__&quot;:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        asyncio.run(main())</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    ```</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Note: Only dicts, lists, and tuples of input data models are supported. Nested</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    inputs are not supported (e.g. lists of list or dicts of dict).</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    ## By subclassing the `Program` class</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    In that case, you should define your</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    modules in `__init__()` and you should implement the program&#39;s structure</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    in `call()` .</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    import synalinks</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    import asyncio</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    class Query(synalinks.DataModel):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        query: str = synalinks.Field(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            description=&quot;The user query&quot;,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        )</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    class AnswerWithThinking(synalinks.DataModel):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        thinking: str = synalinks.Field(</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            description=&quot;Your step by step thinking process&quot;,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        )</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        answer: float = synalinks.Field(</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            description=&quot;The correct numerical answer&quot;,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        )</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    class ChainOfThought(synalinks.Program):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        \&quot;\&quot;\&quot;Useful to answer in a step by step manner.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        The first line of the docstring is provided as description</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        for the program if not provided in the `super().__init__()`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        In a similar way the name is automatically infered based on</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        the class name if not provided.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        \&quot;\&quot;\&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        def __init__(</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            self,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            language_model=None,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            name=None,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            description=None,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            trainable=True,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        ):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            super().__init__(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">                name=name,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">                description=description,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">                trainable=trainable,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            )</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            self.answer = synalinks.Generator(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">                data_model=AnswerWithThinking,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">                language_model=language_model,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">                name=self.name+&quot;_generator&quot;,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            )</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        async def call(self, inputs, training=False):</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            if not inputs:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">                return None</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            x = await self.answer(inputs, training=training)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            return x</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        def get_config(self):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            config = {</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                &quot;name&quot;: self.name,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                &quot;description&quot;: self.description,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                &quot;trainable&quot;: self.trainable,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            }</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            language_model_config = \</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            {</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                &quot;language_model&quot;: synalinks.saving.serialize_synalinks_object(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                    self.language_model</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">                )</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            }</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            return {**config, **language_model_config}</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        @classmethod</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        def from_config(cls, config):</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            language_model = synalinks.saving.deserialize_synalinks_object(</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">                config.pop(&quot;language_model&quot;)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            )</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            return cls(language_model=language_model, **config)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    async def main():</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        language_model = synalinks.LanguageModel(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            model=&quot;ollama/mistral&quot;,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        )</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        program = ChainOfThought(</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            language_model=language_model,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        )</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    ```</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    If you subclass `Program`, you can optionally have</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    a `training` argument (boolean) in `call()`, which you can use to specify</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    a different behavior in training and inference.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    Once the program is created, you can config the program with rewards and metrics</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    with `program.compile()`, train the program with `program.fit()`, or use the program</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    to do prediction with `program.predict()` or `program()`.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    To understand the difference between `program.predict()` or `program()`, read the</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    [FAQ](https://synalinks.github.io/synalinks/FAQ/#whats-the-difference-between-program-methods-predict-and-__call__).</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    ## Mixing the subclassing and the `Functional` API</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    This way of programming is recommended to encapsulate your application while </span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    providing an easy to use setup. It is the recommended way for most users as </span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    it avoid making your program/agents from scratch.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    In that case, you should implement only the `__init__()` and `build()` methods.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    import synalinks</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    import asyncio</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    class Query(synalinks.DataModel):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        query: str = synalinks.Field(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            description=&quot;The user query&quot;,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        )</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    class AnswerWithThinking(synalinks.DataModel):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        thinking: str = synalinks.Field(</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            description=&quot;Your step by step thinking process&quot;,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        )</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        answer: float = synalinks.Field(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            description=&quot;The correct numerical answer&quot;,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        )</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    async def main():</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        class ChainOfThought(synalinks.Program):</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            \&quot;\&quot;\&quot;Useful to answer in a step by step manner.\&quot;\&quot;\&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            def __init__(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">                self,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">                language_model=None,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">                name=None,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">                description=None,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">                trainable=True,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            ):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">                super().__init__(</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">                    name=name,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">                    description=description,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">                    trainable=trainable,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">                )</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">                self.language_model = language_model</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            async def build(self, inputs):</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">                outputs = await synalinks.Generator(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">                    data_model=AnswerWithThinking,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">                    language_model=self.language_model,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">                )(inputs)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">                # Create your program using the functional API</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">                super().__init__(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">                    inputs=inputs,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">                    outputs=outputs,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">                    name=self.name,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">                    description=self.description,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">                    trainable=self.trainable,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">                )</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        language_model = synalinks.LanguageModel(</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            model=&quot;ollama/mistral&quot;,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        )</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        program = ChainOfThought(</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            language_model=language_model,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        )</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    if __name__ == &quot;__main__&quot;:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        asyncio.run(main())</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    ```</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    This allows you to not have to implement the `call()` and serialization methods</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    (`get_config()` and `from_config()`). The program will be built for any inputs </span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    the first time called.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    ## With the `Sequential` class</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    In addition, `synalinks.Sequential` is a special case of program where</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    the program is purely a stack of single-input, single-output modules.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    import synalinks</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    import asyncio</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    class Query(synalinks.DataModel):</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        query: str = synalinks.Field(</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            description=&quot;The user query&quot;,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        )</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    class AnswerWithThinking(synalinks.DataModel):</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        thinking: str = synalinks.Field(</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            description=&quot;Your step by step thinking process&quot;,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        )</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        answer: float = synalinks.Field(</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            description=&quot;The correct numerical answer&quot;,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        )</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    async def main():</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        language_model = synalinks.LanguageModel(model=&quot;ollama/mistral&quot;)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        program = synalinks.Sequential(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            [</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">                synalinks.Input(</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">                    data_model=Query,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">                ),</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">                synalinks.Generator(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">                    data_model=AnswerWithThinking,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">                    language_model=language_model,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">                ),</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            ],</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            name=&quot;chain_of_thought&quot;,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            description=&quot;Useful to answer in a step by step manner.&quot;,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        )</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    if __name__ == &quot;__main__&quot;:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        asyncio.run(main())</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    ```</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="c1"># Signature detection for usage of `Program` as a `Functional`</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="k">if</span> <span class="n">functional_init_arguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">cls</span> <span class="o">==</span> <span class="n">Program</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.programs.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">Functional</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="k">return</span> <span class="n">Functional</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">Functional</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">))</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">Trainer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.programs</span><span class="w"> </span><span class="kn">import</span> <span class="n">functional</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="c1"># Signature detection for usage of a `Program` subclass</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="c1"># as a `Functional` subclass</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">if</span> <span class="n">functional_init_arguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="n">inject_functional_program_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="n">functional</span><span class="o">.</span><span class="n">Functional</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="n">Module</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="sa">f</span><span class="s2">&quot;Program </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> does not have a `call()` &quot;</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="s2">&quot;method implemented.&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">modules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flatten_modules</span><span class="p">(</span><span class="n">include_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="nd">@modules</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">modules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="s2">&quot;`Program.modules` attribute is reserved and should not be used. &quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="s2">&quot;Please use another name.&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a module based on either its name (unique) or index.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        If `name` and `index` are both provided, `index` will take precedence.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Indices are based on order of horizontal graph traversal (bottom-up).</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            name (str): String, name of module.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            index (int): Integer, index of module.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            (Module): A module instance.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="s2">&quot;Provide only a module name or a module index. Received: &quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="sa">f</span><span class="s2">&quot;index=</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">, name=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">index</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                    <span class="sa">f</span><span class="s2">&quot;Was asked to retrieve module at index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                    <span class="sa">f</span><span class="s2">&quot; but program only has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                    <span class="s2">&quot; modules.&quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                    <span class="k">return</span> <span class="n">module</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="sa">f</span><span class="s2">&quot;No such module: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">. Existing modules are: &quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either a module name or module index at `get_module`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">line_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">print_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">expand_nested</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">show_trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">module_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="p">):</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints a string summary of the program.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            line_length (int): Total length of printed lines</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">                (e.g. set this to adapt the display to different</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">                terminal window sizes).</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">            positions (list): Relative or absolute positions of log elements</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">                in each line. If not provided, becomes</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">                `[0.3, 0.6, 0.70, 1.]`. Defaults to `None`.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            print_fn (Callable): Print function to use. By default, prints to `stdout`.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">                If `stdout` doesn&#39;t work in your environment, change to `print`.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">                It will be called on each line of the summary.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">                You can set it to a custom function</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">                in order to capture the string summary.</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            expand_nested (bool): Whether to expand the nested models.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">                Defaults to `False`.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            show_trainable (bool): Whether to show if a module is trainable.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">                Defaults to `False`.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            module_range (list | tuple): a list or tuple of 2 strings,</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">                which is the starting module name and ending module name</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">                (both inclusive) indicating the range of modules to be printed</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">                in summary. It also accepts regex patterns instead of exact</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">                names. In this case, the start predicate will be</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">                the first element that matches `module_range[0]`</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">                and the end predicate will be the last element</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">                that matches `module_range[1]`.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">                By default `None` considers all modules of the model.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            ValueError: if `summary()` is called before the model is built.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">summary_utils</span><span class="o">.</span><span class="n">print_summary</span><span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="n">line_length</span><span class="o">=</span><span class="n">line_length</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">print_fn</span><span class="o">=</span><span class="n">print_fn</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">expand_nested</span><span class="o">=</span><span class="n">expand_nested</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">show_trainable</span><span class="o">=</span><span class="n">show_trainable</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">module_range</span><span class="o">=</span><span class="n">module_range</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves a program as a `.json` file.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        import synalinks</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        class Query(synalinks.DataModel):</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">            query: str</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        class AnswerWithRationale(synalinks.DataModel):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">            rationale: str</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            answer: str</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        language_model = LanguageModel(&quot;ollama/mistral&quot;)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        program = synalinks.Sequential(</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">            [</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">                synalinks.Input(data_model=Query),</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">                synalinks.Generator(</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">                    data_model=AnswerWithRationale,</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">                    language_model=language_model,</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">                ),</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            ],</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        )</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        program.save(&quot;program.json&quot;)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        loaded_program = synalinks.programs.program_from_json(&quot;program.json&quot;)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        ```</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        The saved `.json` file contains:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        - The program&#39;s configuration (architecture)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        - The program&#39;s variables</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        - The program&#39;s optimizer&#39;s state (if any)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        - The program&#39;s reward&#39;s state (if any)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        Thus programs can be reinstantiated in the exact same state.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            filepath (str | os.PathLike): `str` or `os.PathLike` object.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">                The path where to save the model. Must end in `.json`.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">            overwrite (bool): Whether we should overwrite any existing program at</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">                the target location, or instead ask the user via</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">                an interactive prompt. Default to `True`.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.saving</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization_lib</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                <span class="sa">f</span><span class="s2">&quot;The filepath should ends with &#39;.json&#39;, received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">program_config</span> <span class="o">=</span> <span class="n">serialization_lib</span><span class="o">.</span><span class="n">serialize_synalinks_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">variables_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state_tree</span><span class="p">()</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="n">program_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">variables_config</span><span class="p">})</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">program_config_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">program_config</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="k">if</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="n">io_utils</span><span class="o">.</span><span class="n">ask_to_proceed_with_overwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">program_config_string</span><span class="p">)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">build_from_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="k">return</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">if</span> <span class="s2">&quot;input_schema&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="c1"># Case: all inputs are in the first arg (possibly nested).</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_by_run_for_single_pos_arg</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;input_schema&quot;</span><span class="p">])</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;input_schema&quot;</span><span class="p">])</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>                    <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_schemas_dict</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">elif</span> <span class="s2">&quot;schemas_dict&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="c1"># Case: inputs were recorded as multiple keyword arguments.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">):</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_by_run_for_kwargs</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;schemas_dict&quot;</span><span class="p">])</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;schemas_dict&quot;</span><span class="p">])</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                    <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_schemas_dict</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;schemas_dict&quot;</span><span class="p">]</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="sa">f</span><span class="s2">&quot;Program &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; had a build config, but the program &quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="s2">&quot;cannot be built automatically in &quot;</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="s2">&quot;`build_from_config(config)`. &quot;</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="s2">&quot;You should implement &quot;</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="s2">&quot;`def build_from_config(self, config)`, &quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                <span class="s2">&quot;and you might also want to implement the method &quot;</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                <span class="s2">&quot; that generates the config at saving time, &quot;</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="s2">&quot;`def get_build_config(self)`. &quot;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="s2">&quot;The method `build_from_config()` is meant to &quot;</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="s2">&quot;create the state of the model (i.e. its variables) &quot;</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="s2">&quot;upon deserialization.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="p">)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a JSON string containing the network configuration.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        json_string = program.to_json()</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        ```</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">        To load a network from a JSON save file, use</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">        `synalinks.programs.program_from_json(json_string, custom_objects={...})`.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            **kwargs (keyword arguments): Additional keyword arguments to be passed to</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">                `json.dumps()`.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            (str): A JSON string.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.saving</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization_lib</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">program_config</span> <span class="o">=</span> <span class="n">serialization_lib</span><span class="o">.</span><span class="n">serialize_synalinks_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">program_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.programs.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">Functional</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">functional_config_keys</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="s2">&quot;name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="s2">&quot;modules&quot;</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="s2">&quot;input_modules&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="s2">&quot;output_modules&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="p">]</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">is_functional_config</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">config</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">functional_config_keys</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">argspec</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">functional_init_args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="n">Functional</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">revivable_as_functional</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>            <span class="bp">cls</span> <span class="ow">in</span> <span class="p">{</span><span class="n">Functional</span><span class="p">,</span> <span class="n">Program</span><span class="p">}</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>            <span class="ow">or</span> <span class="n">argspec</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="n">functional_init_args</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>            <span class="ow">or</span> <span class="p">(</span><span class="n">argspec</span><span class="o">.</span><span class="n">varargs</span> <span class="o">==</span> <span class="s2">&quot;args&quot;</span> <span class="ow">and</span> <span class="n">argspec</span><span class="o">.</span><span class="n">varkw</span> <span class="o">==</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="k">if</span> <span class="n">is_functional_config</span> <span class="ow">and</span> <span class="n">revivable_as_functional</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="c1"># Revive Functional model</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>            <span class="c1"># (but not Functional subclasses with a custom __init__)</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.programs.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">functional_from_config</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>            <span class="k">return</span> <span class="n">functional_from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="c1"># Either the model has a custom __init__, or the config</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="c1"># does not contain all the information necessary to</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="c1"># revive a Functional model. This happens when the user creates</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="c1"># subclassed models where `get_config()` is returning</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="c1"># insufficient information to be considered a Functional model.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="c1"># In this case, we fall back to provide all config into the</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="c1"># constructor of the class.</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>                <span class="s2">&quot;Unable to revive program from config. When overriding &quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>                <span class="s2">&quot;the `get_config()` method, make sure that the &quot;</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>                <span class="s2">&quot;returned config contains all items used as arguments &quot;</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>                <span class="sa">f</span><span class="s2">&quot;in the  constructor to </span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>                <span class="s2">&quot;which is the default behavior. &quot;</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>                <span class="s2">&quot;You can override this default behavior by defining a &quot;</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>                <span class="s2">&quot;`from_config(cls, config)` class method to specify &quot;</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="s2">&quot;how to create an &quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                <span class="sa">f</span><span class="s2">&quot;instance of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from its config.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                <span class="sa">f</span><span class="s2">&quot;Received config=</span><span class="si">{</span><span class="n">config</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>                <span class="sa">f</span><span class="s2">&quot;Error encountered during deserialization: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_state_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves tree-like structure of program variables.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        This method allows retrieval of different program variables (trainable,</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">        non-trainable, optimizer, and metrics). The variables are returned in a</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">        nested dictionary format, where the keys correspond to the variable</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        names and the values are the nested representations of the variables.</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        program.compile(</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">            optimizer=synalinks.optimizers.RandomFewShot(),</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">            reward=synalinks.rewards.ExactMatch(),</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        )</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        program.fit(x=x_train, y=y_train)</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        state_tree = program.get_state_tree()</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        ```</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">            (dict): A dictionary containing the nested representations of the</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">                requested variables. The keys are the variable names, and the</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">                values are the corresponding nested dictionaries.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="n">variables</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;trainable_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trainable_variables</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>        <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;non_trainable_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">non_trainable_variables</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>            <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;optimizer_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">variables</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="p">)</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;metrics_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics_variables</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="k">return</span> <span class="n">variables</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="n">flat_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">path</span> <span class="ow">in</span> <span class="n">flat_dict</span><span class="p">:</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                    <span class="s2">&quot;The following variable path is found twice in the program: &quot;</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39;. `get_state_tree()` can only be called when &quot;</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                    <span class="s2">&quot;all variable paths are unique. Make sure to give unique &quot;</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                    <span class="s2">&quot;names to your modules (and other objects).&quot;</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                <span class="p">)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="n">flat_dict</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="n">nested_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">flat_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>            <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>            <span class="n">current_dict</span> <span class="o">=</span> <span class="n">nested_dict</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>                <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_dict</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>                    <span class="n">current_dict</span><span class="p">[</span><span class="n">part</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>                <span class="n">current_dict</span> <span class="o">=</span> <span class="n">current_dict</span><span class="p">[</span><span class="n">part</span><span class="p">]</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="n">current_dict</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">return</span> <span class="n">nested_dict</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_state_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_tree</span><span class="p">):</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assigns values to variables of the program.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        This method takes a dictionary of nested variable values, which</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        represents the state tree of the program, and assigns them to the</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        corresponding variables of the program. The dictionary keys represent the</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        variable names (e.g., `&#39;trainable_variables&#39;`, `&#39;optimizer_variables&#39;`),</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        and the values are nested dictionaries containing the variable</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        paths and their corresponding values.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">            state_tree (dict): A dictionary representing the state tree of the program.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">                The keys are the variable names, and the values are nested</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">                dictionaries representing the variable paths and their values.</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state_tree</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="n">path_value_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flatten_nested_dict</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;trainable_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">,</span> <span class="n">path_value_dict</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;non_trainable_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">non_trainable_variables</span><span class="p">,</span> <span class="n">path_value_dict</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                <span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;optimizer_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">path_value_dict</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                    <span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;metrics_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics_variables</span><span class="p">,</span> <span class="n">path_value_dict</span><span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown variable name: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_assign_variable_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">path_value_dict</span><span class="p">):</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="k">for</span> <span class="n">full_path</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">path_value_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>            <span class="n">path_parts</span> <span class="o">=</span> <span class="n">full_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>            <span class="n">field_name</span> <span class="o">=</span> <span class="n">path_parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>            <span class="n">parent_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>                <span class="n">variable_path</span> <span class="o">=</span> <span class="n">remove_numerical_suffix</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                <span class="k">if</span> <span class="n">parent_path</span> <span class="o">==</span> <span class="n">variable_path</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                    <span class="n">variable</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">field_name</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                    <span class="k">break</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                    <span class="n">nested_field_name</span> <span class="o">=</span> <span class="n">parent_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                    <span class="k">if</span> <span class="n">parent_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">variable_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                        <span class="n">nested_field_name</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                    <span class="p">):</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                        <span class="n">variable</span><span class="o">.</span><span class="n">get_json</span><span class="p">()[</span><span class="n">nested_field_name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">field_name</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>                        <span class="k">break</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_flatten_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested_dict</span><span class="p">):</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="n">flat_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_flatten</span><span class="p">(</span><span class="n">current_dict</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">current_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>                    <span class="n">_flatten</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                    <span class="n">flat_dict</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">_flatten</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="k">return</span> <span class="n">flat_dict</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves all module variables to a `.variables.json` file.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">            filepath (str | pathlib.Path): `str` or `pathlib.Path` object.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">                Path where to save the program. Must end in `.variables.json`.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">            overwrite (bool): Whether we should overwrite any existing program</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">                at the target location, or instead ask the user</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">                via an interactive prompt.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.variables.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="s2">&quot;The filepath should ends with &#39;.variables.json&#39;, &quot;</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>                <span class="sa">f</span><span class="s2">&quot;received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="p">)</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state_tree</span><span class="p">()</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="n">config_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="k">if</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="n">io_utils</span><span class="o">.</span><span class="n">ask_to_proceed_with_overwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">config_string</span><span class="p">)</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load all module variables from a `.variable.json` file.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">            filepath (str | pathlib.Path): `str` or `pathlib.Path` object.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">                Path to load the program&#39;s variables from.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">                Must end in `.variables.json`.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.variables.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                <span class="s2">&quot;The filepath should ends with &#39;.variables.json&#39;, &quot;</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="sa">f</span><span class="s2">&quot;received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="n">state_tree_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_state_tree</span><span class="p">(</span><span class="n">state_tree_config</span><span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a program from a JSON file.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">        import synalinks</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        loaded_program = synalinks.Program.load(&quot;program.json&quot;)</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        ```</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">            filepath (str | pathlib.Path): `str` or `pathlib.Path` object.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">                Path to load the program&#39;s variables from.</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">                Must end in `.variables.json`.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">            custom_objects (dict): Optional dictionary mapping names</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">                (strings) to custom classes or functions to be</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">                considered during deserialization.</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">            (Program): A Synalinks program instance (uncompiled).</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                <span class="sa">f</span><span class="s2">&quot;The filepath should ends with &#39;.json&#39;, received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">json_config</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="k">return</span> <span class="n">program_from_json</span><span class="p">(</span><span class="n">json_config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.get_module" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_module</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieves a module based on either its name (unique) or index.</p>
<p>If <code>name</code> and <code>index</code> are both provided, <code>index</code> will take precedence.
Indices are based on order of horizontal graph traversal (bottom-up).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String, name of module.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integer, index of module.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="synalinks.src.modules.Module" href="../../Modules%20API/Base%20Module%20class/#synalinks.src.modules.module.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A module instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves a module based on either its name (unique) or index.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    If `name` and `index` are both provided, `index` will take precedence.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    Indices are based on order of horizontal graph traversal (bottom-up).</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        name (str): String, name of module.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        index (int): Integer, index of module.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        (Module): A module instance.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="s2">&quot;Provide only a module name or a module index. Received: &quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="sa">f</span><span class="s2">&quot;index=</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">, name=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">index</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="sa">f</span><span class="s2">&quot;Was asked to retrieve module at index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="sa">f</span><span class="s2">&quot; but program only has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="s2">&quot; modules.&quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="k">return</span> <span class="n">module</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="sa">f</span><span class="s2">&quot;No such module: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">. Existing modules are: &quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either a module name or module index at `get_module`.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.get_state_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_state_tree</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieves tree-like structure of program variables.</p>
<p>This method allows retrieval of different program variables (trainable,
non-trainable, optimizer, and metrics). The variables are returned in a
nested dictionary format, where the keys correspond to the variable
names and the values are the nested representations of the variables.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">program</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">synalinks</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">RandomFewShot</span><span class="p">(),</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">reward</span><span class="o">=</span><span class="n">synalinks</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">ExactMatch</span><span class="p">(),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">program</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">state_tree</span> <span class="o">=</span> <span class="n">program</span><span class="o">.</span><span class="n">get_state_tree</span><span class="p">()</span>
</code></pre></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the nested representations of the
requested variables. The keys are the variable names, and the
values are the corresponding nested dictionaries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_state_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves tree-like structure of program variables.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    This method allows retrieval of different program variables (trainable,</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">    non-trainable, optimizer, and metrics). The variables are returned in a</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">    nested dictionary format, where the keys correspond to the variable</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    names and the values are the nested representations of the variables.</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    program.compile(</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        optimizer=synalinks.optimizers.RandomFewShot(),</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        reward=synalinks.rewards.ExactMatch(),</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">    )</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">    program.fit(x=x_train, y=y_train)</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    state_tree = program.get_state_tree()</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    ```</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        (dict): A dictionary containing the nested representations of the</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">            requested variables. The keys are the variable names, and the</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">            values are the corresponding nested dictionaries.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="n">variables</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;trainable_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainable_variables</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;non_trainable_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">non_trainable_variables</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;optimizer_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">variables</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="p">)</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;metrics_variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics_variables</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="k">return</span> <span class="n">variables</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Load a program from a JSON file.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">synalinks</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">loaded_program</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Program</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;program.json&quot;</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>str</code> or <code>pathlib.Path</code> object.
Path to load the program's variables from.
Must end in <code>.variables.json</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_objects</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary mapping names
(strings) to custom classes or functions to be
considered during deserialization.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="synalinks.src.programs.program.Program" href="#synalinks.src.programs.program.Program">Program</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Synalinks program instance (uncompiled).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a program from a JSON file.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">    import synalinks</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    loaded_program = synalinks.Program.load(&quot;program.json&quot;)</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">    ```</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">        filepath (str | pathlib.Path): `str` or `pathlib.Path` object.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">            Path to load the program&#39;s variables from.</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">            Must end in `.variables.json`.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">        custom_objects (dict): Optional dictionary mapping names</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">            (strings) to custom classes or functions to be</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">            considered during deserialization.</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">        (Program): A Synalinks program instance (uncompiled).</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="sa">f</span><span class="s2">&quot;The filepath should ends with &#39;.json&#39;, received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">json_config</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>    <span class="k">return</span> <span class="n">program_from_json</span><span class="p">(</span><span class="n">json_config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.load_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_variables</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Load all module variables from a <code>.variable.json</code> file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>str</code> or <code>pathlib.Path</code> object.
Path to load the program's variables from.
Must end in <code>.variables.json</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load all module variables from a `.variable.json` file.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">        filepath (str | pathlib.Path): `str` or `pathlib.Path` object.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">            Path to load the program&#39;s variables from.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">            Must end in `.variables.json`.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.variables.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>            <span class="s2">&quot;The filepath should ends with &#39;.variables.json&#39;, &quot;</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="sa">f</span><span class="s2">&quot;received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="n">state_tree_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_state_tree</span><span class="p">(</span><span class="n">state_tree_config</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Saves a program as a <code>.json</code> file.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">synalinks</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Query</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnswerWithRationale</span><span class="p">(</span><span class="n">synalinks</span><span class="o">.</span><span class="n">DataModel</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">rationale</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">answer</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">language_model</span> <span class="o">=</span> <span class="n">LanguageModel</span><span class="p">(</span><span class="s2">&quot;ollama/mistral&quot;</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">program</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="p">[</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="n">synalinks</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">data_model</span><span class="o">=</span><span class="n">Query</span><span class="p">),</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="n">synalinks</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            <span class="n">data_model</span><span class="o">=</span><span class="n">AnswerWithRationale</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>            <span class="n">language_model</span><span class="o">=</span><span class="n">language_model</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="p">),</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="p">],</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">program</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;program.json&quot;</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">loaded_program</span> <span class="o">=</span> <span class="n">synalinks</span><span class="o">.</span><span class="n">programs</span><span class="o">.</span><span class="n">program_from_json</span><span class="p">(</span><span class="s2">&quot;program.json&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The saved <code>.json</code> file contains:</p>
<ul>
<li>The program's configuration (architecture)</li>
<li>The program's variables</li>
<li>The program's optimizer's state (if any)</li>
<li>The program's reward's state (if any)</li>
</ul>
<p>Thus programs can be reinstantiated in the exact same state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="os.PathLike">PathLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>str</code> or <code>os.PathLike</code> object.
The path where to save the model. Must end in <code>.json</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether we should overwrite any existing program at
the target location, or instead ask the user via
an interactive prompt. Default to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a program as a `.json` file.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    import synalinks</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    class Query(synalinks.DataModel):</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        query: str</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    class AnswerWithRationale(synalinks.DataModel):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        rationale: str</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        answer: str</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    language_model = LanguageModel(&quot;ollama/mistral&quot;)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    program = synalinks.Sequential(</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        [</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            synalinks.Input(data_model=Query),</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            synalinks.Generator(</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">                data_model=AnswerWithRationale,</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">                language_model=language_model,</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            ),</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        ],</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    )</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    program.save(&quot;program.json&quot;)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    loaded_program = synalinks.programs.program_from_json(&quot;program.json&quot;)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    ```</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    The saved `.json` file contains:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    - The program&#39;s configuration (architecture)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    - The program&#39;s variables</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    - The program&#39;s optimizer&#39;s state (if any)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">    - The program&#39;s reward&#39;s state (if any)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">    Thus programs can be reinstantiated in the exact same state.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        filepath (str | os.PathLike): `str` or `os.PathLike` object.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            The path where to save the model. Must end in `.json`.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        overwrite (bool): Whether we should overwrite any existing program at</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            the target location, or instead ask the user via</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            an interactive prompt. Default to `True`.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.saving</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization_lib</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="sa">f</span><span class="s2">&quot;The filepath should ends with &#39;.json&#39;, received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="n">program_config</span> <span class="o">=</span> <span class="n">serialization_lib</span><span class="o">.</span><span class="n">serialize_synalinks_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">variables_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state_tree</span><span class="p">()</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">program_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">variables_config</span><span class="p">})</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">program_config_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">program_config</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="k">if</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">io_utils</span><span class="o">.</span><span class="n">ask_to_proceed_with_overwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">program_config_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.save_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_variables</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Saves all module variables to a <code>.variables.json</code> file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>str</code> or <code>pathlib.Path</code> object.
Path where to save the program. Must end in <code>.variables.json</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether we should overwrite any existing program
at the target location, or instead ask the user
via an interactive prompt.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves all module variables to a `.variables.json` file.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        filepath (str | pathlib.Path): `str` or `pathlib.Path` object.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">            Path where to save the program. Must end in `.variables.json`.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">        overwrite (bool): Whether we should overwrite any existing program</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            at the target location, or instead ask the user</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">            via an interactive prompt.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">path_to_string</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.variables.json&quot;</span><span class="p">):</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="s2">&quot;The filepath should ends with &#39;.variables.json&#39;, &quot;</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="sa">f</span><span class="s2">&quot;received filepath=</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="p">)</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>    <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state_tree</span><span class="p">()</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>    <span class="n">config_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="k">if</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="n">io_utils</span><span class="o">.</span><span class="n">ask_to_proceed_with_overwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">config_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.set_state_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_state_tree</span><span class="p">(</span><span class="n">state_tree</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Assigns values to variables of the program.</p>
<p>This method takes a dictionary of nested variable values, which
represents the state tree of the program, and assigns them to the
corresponding variables of the program. The dictionary keys represent the
variable names (e.g., <code>'trainable_variables'</code>, <code>'optimizer_variables'</code>),
and the values are nested dictionaries containing the variable
paths and their corresponding values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state_tree</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary representing the state tree of the program.
The keys are the variable names, and the values are nested
dictionaries representing the variable paths and their values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_state_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_tree</span><span class="p">):</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assigns values to variables of the program.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    This method takes a dictionary of nested variable values, which</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    represents the state tree of the program, and assigns them to the</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">    corresponding variables of the program. The dictionary keys represent the</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">    variable names (e.g., `&#39;trainable_variables&#39;`, `&#39;optimizer_variables&#39;`),</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">    and the values are nested dictionaries containing the variable</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">    paths and their corresponding values.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        state_tree (dict): A dictionary representing the state tree of the program.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">            The keys are the variable names, and the values are nested</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">            dictionaries representing the variable paths and their values.</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state_tree</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">path_value_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flatten_nested_dict</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;trainable_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">,</span> <span class="n">path_value_dict</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;non_trainable_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">non_trainable_variables</span><span class="p">,</span> <span class="n">path_value_dict</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;optimizer_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">path_value_dict</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;metrics_variables&quot;</span><span class="p">:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variable_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics_variables</span><span class="p">,</span> <span class="n">path_value_dict</span><span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown variable name: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">line_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expand_nested</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">module_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prints a string summary of the program.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>line_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total length of printed lines
(e.g. set this to adapt the display to different
terminal window sizes).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative or absolute positions of log elements
in each line. If not provided, becomes
<code>[0.3, 0.6, 0.70, 1.]</code>. Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_fn</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print function to use. By default, prints to <code>stdout</code>.
If <code>stdout</code> doesn't work in your environment, change to <code>print</code>.
It will be called on each line of the summary.
You can set it to a custom function
in order to capture the string summary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expand_nested</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to expand the nested models.
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_trainable</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show if a module is trainable.
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>module_range</code>
            </td>
            <td>
                  <code><span title="list">list</span> | <span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list or tuple of 2 strings,
which is the starting module name and ending module name
(both inclusive) indicating the range of modules to be printed
in summary. It also accepts regex patterns instead of exact
names. In this case, the start predicate will be
the first element that matches <code>module_range[0]</code>
and the end predicate will be the last element
that matches <code>module_range[1]</code>.
By default <code>None</code> considers all modules of the model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>summary()</code> is called before the model is built.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">line_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">print_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">expand_nested</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">show_trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">module_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="p">):</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints a string summary of the program.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        line_length (int): Total length of printed lines</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            (e.g. set this to adapt the display to different</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            terminal window sizes).</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        positions (list): Relative or absolute positions of log elements</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            in each line. If not provided, becomes</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            `[0.3, 0.6, 0.70, 1.]`. Defaults to `None`.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        print_fn (Callable): Print function to use. By default, prints to `stdout`.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">            If `stdout` doesn&#39;t work in your environment, change to `print`.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">            It will be called on each line of the summary.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">            You can set it to a custom function</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">            in order to capture the string summary.</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        expand_nested (bool): Whether to expand the nested models.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">            Defaults to `False`.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        show_trainable (bool): Whether to show if a module is trainable.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            Defaults to `False`.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        module_range (list | tuple): a list or tuple of 2 strings,</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            which is the starting module name and ending module name</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            (both inclusive) indicating the range of modules to be printed</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            in summary. It also accepts regex patterns instead of exact</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            names. In this case, the start predicate will be</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            the first element that matches `module_range[0]`</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            and the end predicate will be the last element</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            that matches `module_range[1]`.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            By default `None` considers all modules of the model.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        ValueError: if `summary()` is called before the model is built.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="n">summary_utils</span><span class="o">.</span><span class="n">print_summary</span><span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">line_length</span><span class="o">=</span><span class="n">line_length</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">print_fn</span><span class="o">=</span><span class="n">print_fn</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">expand_nested</span><span class="o">=</span><span class="n">expand_nested</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="n">show_trainable</span><span class="o">=</span><span class="n">show_trainable</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">module_range</span><span class="o">=</span><span class="n">module_range</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="synalinks.src.programs.program.Program.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns a JSON string containing the network configuration.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">json_string</span> <span class="o">=</span> <span class="n">program</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</code></pre></div>
<p>To load a network from a JSON save file, use
<code>synalinks.programs.program_from_json(json_string, custom_objects={...})</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>keyword arguments</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to be passed to
<code>json.dumps()</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JSON string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>synalinks/src/programs/program.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a JSON string containing the network configuration.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    json_string = program.to_json()</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    ```</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    To load a network from a JSON save file, use</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    `synalinks.programs.program_from_json(json_string, custom_objects={...})`.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        **kwargs (keyword arguments): Additional keyword arguments to be passed to</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            `json.dumps()`.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        (str): A JSON string.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">synalinks.src.saving</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization_lib</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">program_config</span> <span class="o">=</span> <span class="n">serialization_lib</span><span class="o">.</span><span class="n">serialize_synalinks_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">program_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>